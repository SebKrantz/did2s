<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Inform modern browsers that this page supports both dark and light color schemes,
  and the page author prefers light. --><meta name="color-scheme" content="dark light">
<script>
  // If `prefers-color-scheme` is not supported, fall back to light mode.
  // i.e. In this case, inject the `light` CSS before the others, with
  // no media filter so that it will be downloaded with highest priority.
  if (window.matchMedia("(prefers-color-scheme: dark)").media === "not all") {
    document.documentElement.style.display = "none";
    document.head.insertAdjacentHTML(
      "beforeend",
      "<link id=\"css\" rel=\"stylesheet\" href=\"https://bootswatch.com/3/flatly/bootstrap.css\" onload=\"document.documentElement.style.display = ''\">"
    );
  }
</script><title>Estimate Two-Stage Difference-in-Differences following Gardner (2021) • did2s</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- Flatly Theme - Light  --><link id="css-light" rel="stylesheet" href="https://bootswatch.com/3/flatly/bootstrap.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<!-- Darkly Theme - Dark --><link id="css-dark" rel="stylesheet" href="https://bootswatch.com/3/darkly/bootstrap.css" media="(prefers-color-scheme: dark)">
<!-- preferably CSS --><link rel="stylesheet" href="preferably.css">
<link id="css-code-light" rel="stylesheet" href="code-color-scheme-light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
<link id="css-code-dark" rel="stylesheet" href="code-color-scheme-dark.css" media="(prefers-color-scheme: dark)">
<!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimate Two-Stage Difference-in-Differences following Gardner (2021)">
<meta property="og:description" content="This package creates the funciton `did2s` which allows you to estimate TWFE diff-in-diff/event-study models. To avoid the problems caused by OLS estimation of the TWFE model, this function first estimates the fixed effects and covariates using untreated observations and then in a second stage, estimates the treatment effects.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">did2s</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Two-Stage-Difference-in-Differences.html">Two-Stage-Difference-in-Differences</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="did2s" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#did2s" class="anchor"></a>did2s</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of did2s is to estimate TWFE models without running into the problem of staggered treatment adoption.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install did2s from github with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"kylebutts/did2s"</span>)</span></code></pre></div>
</div>
<div id="two-stage-difference-in-differences-gardner-2021" class="section level2">
<h2 class="hasAnchor">
<a href="#two-stage-difference-in-differences-gardner-2021" class="anchor"></a>Two-stage Difference-in-differences (Gardner 2021)</h2>
<p>For details on the methodology, view this <a href="http://kylebutts.com/did2s/articles/Two-Stage-Difference-in-Differences.html">vignette</a></p>
<p>I have created an R package with the help of John Gardner to estimate the two-stage difference-in-differences estimator. To install the package, run the following:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"kylebutts/did2s"</span>)</span></code></pre></div>
<p>To view the documentation, type <code><a href="reference/did2s.html">?did2s</a></code> into the console.</p>
<p>The main function is <code>did2s</code> which estimates the two-stage did procedure. This function requires the following options:</p>
<ul>
<li>
<code>yname</code>: the outcome variable</li>
<li>
<code>first_stage_formula</code>: formula for first stage, can include fixed effects and covariates, but do not include treatment variable(s)!</li>
<li>
<code>treat_formula</code>: This should be the treatment variable or in the case of event studies, treatment variables.</li>
<li>
<code>treat_var</code>: This has to be the 0/1 treatment variable that marks when treatment turns on for a unit. If you suspect anticipation, see note above for accounting for this.</li>
<li>
<code>cluster_var</code>: Which variables to cluster on</li>
<li>
<code>weights</code>: Optional variable to run a weighted first- and second-stage regressions</li>
<li>
<code>bootstrap</code>: Should standard errors be bootstrapped instead? Default is False.</li>
<li>
<code>n_bootstraps</code>: How many clustered bootstraps to perform for standard errors. Default is 250.</li>
</ul>
<p>did2s returns a list with two objects:</p>
<ol>
<li>fixest estimate for the second stage with corrected standard errors.</li>
</ol>
<div id="twfe-vs-two-stage-did-example" class="section level3">
<h3 class="hasAnchor">
<a href="#twfe-vs-two-stage-did-example" class="anchor"></a>TWFE vs. Two-Stage DID Example</h3>
<p>I will load example data from the package and plot the average outcome among the groups. Here is one unit’s data:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="co">#&gt; ✓ ggplot2 3.3.3     ✓ purrr   0.3.4</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="co">#&gt; ✓ tibble  3.1.2     ✓ dplyr   1.0.6</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a><span class="co">#&gt; ✓ tidyr   1.1.3     ✓ stringr 1.4.0</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a><span class="co">#&gt; ✓ readr   1.4.0     ✓ forcats 0.5.1</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a><span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a><span class="co">#&gt; x dplyr::filter() masks stats::filter()</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a><span class="co">#&gt; x dplyr::lag()    masks stats::lag()</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a><span class="kw">library</span>(did2s)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a><span class="kw">library</span>(fixest)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a><span class="co">#&gt; fixest 0.9.0, BREAKING changes! </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a><span class="co">#&gt; In i():</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a><span class="co">#&gt;   a) the first two arguments have been swapped! Now it's i(factor_var, continuous_var) for interactions. </span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a><span class="co">#&gt;   b) argument 'drop' has been removed (put everything in 'ref' now).</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a><span class="kw">library</span>(rmarkdown)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a><span class="co"># Load theme</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a><span class="kw">source</span>(<span class="st">"https://raw.githubusercontent.com/kylebutts/templates/master/ggplot_theme/theme_kyle.R"</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a><span class="co">#&gt; Loading required package: showtext</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true"></a><span class="co">#&gt; Loading required package: sysfonts</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true"></a><span class="co">#&gt; Loading required package: showtextdb</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true"></a><span class="co"># Load Data from R package</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true"></a><span class="kw">data</span>(<span class="st">"df_het"</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true"></a><span class="co"># One observation</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true"></a>df_het <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(unit, g, year, treat, rel_year, dep_var) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dt">n =</span> <span class="dv">31</span>) <span class="op">%&gt;%</span><span class="st"> </span>pander<span class="op">::</span><span class="kw">pander</span>()</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="center">unit</th>
<th align="center">g</th>
<th align="center">year</th>
<th align="center">treat</th>
<th align="center">rel_year</th>
<th align="center">dep_var</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">1990</td>
<td align="center">FALSE</td>
<td align="center">-10</td>
<td align="center">4.738</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">1991</td>
<td align="center">FALSE</td>
<td align="center">-9</td>
<td align="center">4.352</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">1992</td>
<td align="center">FALSE</td>
<td align="center">-8</td>
<td align="center">3.108</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">1993</td>
<td align="center">FALSE</td>
<td align="center">-7</td>
<td align="center">6.473</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">1994</td>
<td align="center">FALSE</td>
<td align="center">-6</td>
<td align="center">7.35</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">1995</td>
<td align="center">FALSE</td>
<td align="center">-5</td>
<td align="center">6.33</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">1996</td>
<td align="center">FALSE</td>
<td align="center">-4</td>
<td align="center">5.729</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">1997</td>
<td align="center">FALSE</td>
<td align="center">-3</td>
<td align="center">6.651</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">1998</td>
<td align="center">FALSE</td>
<td align="center">-2</td>
<td align="center">9.263</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">1999</td>
<td align="center">FALSE</td>
<td align="center">-1</td>
<td align="center">5.737</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2000</td>
<td align="center">TRUE</td>
<td align="center">0</td>
<td align="center">5.981</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2001</td>
<td align="center">TRUE</td>
<td align="center">1</td>
<td align="center">7.501</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2002</td>
<td align="center">TRUE</td>
<td align="center">2</td>
<td align="center">6.519</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2003</td>
<td align="center">TRUE</td>
<td align="center">3</td>
<td align="center">7.725</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2004</td>
<td align="center">TRUE</td>
<td align="center">4</td>
<td align="center">6.123</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2005</td>
<td align="center">TRUE</td>
<td align="center">5</td>
<td align="center">6.874</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2006</td>
<td align="center">TRUE</td>
<td align="center">6</td>
<td align="center">9.367</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2007</td>
<td align="center">TRUE</td>
<td align="center">7</td>
<td align="center">9.811</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2008</td>
<td align="center">TRUE</td>
<td align="center">8</td>
<td align="center">9.136</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2009</td>
<td align="center">TRUE</td>
<td align="center">9</td>
<td align="center">10.67</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2010</td>
<td align="center">TRUE</td>
<td align="center">10</td>
<td align="center">6.404</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2011</td>
<td align="center">TRUE</td>
<td align="center">11</td>
<td align="center">6.77</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2012</td>
<td align="center">TRUE</td>
<td align="center">12</td>
<td align="center">8.506</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2013</td>
<td align="center">TRUE</td>
<td align="center">13</td>
<td align="center">7.379</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2014</td>
<td align="center">TRUE</td>
<td align="center">14</td>
<td align="center">7.088</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2015</td>
<td align="center">TRUE</td>
<td align="center">15</td>
<td align="center">7.383</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2016</td>
<td align="center">TRUE</td>
<td align="center">16</td>
<td align="center">6.786</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2017</td>
<td align="center">TRUE</td>
<td align="center">17</td>
<td align="center">9.125</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2018</td>
<td align="center">TRUE</td>
<td align="center">18</td>
<td align="center">8.458</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2019</td>
<td align="center">TRUE</td>
<td align="center">19</td>
<td align="center">6.371</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2000</td>
<td align="center">2020</td>
<td align="center">TRUE</td>
<td align="center">20</td>
<td align="center">5.908</td>
</tr>
</tbody>
</table>
<p>Here is a plot of the average outcome variable for each of the groups:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="co"># Plot Data </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>df_avg &lt;-<span class="st"> </span>df_het <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(group, year) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">dep_var =</span> <span class="kw">mean</span>(dep_var), <span class="dt">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a><span class="co"># Get treatment years for plotting</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>gs &lt;-<span class="st"> </span>df_het <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(treat <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a><span class="st">  </span><span class="kw">pull</span>(g) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unique</span>()</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a>    </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a>    </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">data =</span> df_avg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> dep_var, <span class="dt">x =</span> year, <span class="dt">color =</span> group), <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> gs <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dt">linetype =</span> <span class="st">"dashed"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_kyle</span>(<span class="dt">base_size =</span> <span class="dv">16</span>) <span class="op">+</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>) <span class="op">+</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">"Outcome"</span>, <span class="dt">x =</span> <span class="st">"Year"</span>, <span class="dt">color =</span> <span class="st">"Treatment Cohort"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">expansion</span>(<span class="dt">add =</span> <span class="fl">.5</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">"Group 1"</span> =<span class="st"> "#d2382c"</span>, <span class="st">"Group 2"</span> =<span class="st"> "#497eb3"</span>, <span class="st">"Group 3"</span> =<span class="st"> "#8e549f"</span>)) </span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plot-df-het-1.png" alt="Example data with heterogeneous treatment effects" width="100%"><p class="caption">
Example data with heterogeneous treatment effects
</p>
</div>
</div>
<div id="estimate-two-stage-difference-in-differences" class="section level3">
<h3 class="hasAnchor">
<a href="#estimate-two-stage-difference-in-differences" class="anchor"></a>Estimate Two-stage Difference-in-Differences</h3>
<p>First, lets estimate a static did:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co"># Static</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>static &lt;-<span class="st"> </span><span class="kw">did2s</span>(df_het, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a>                <span class="dt">yname =</span> <span class="st">"dep_var"</span>, <span class="dt">first_stage_formula =</span> <span class="op">~</span><span class="kw">i</span>(state) <span class="op">+</span><span class="st"> </span><span class="kw">i</span>(year), </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a>                <span class="dt">treat_formula =</span> <span class="op">~</span><span class="kw">i</span>(treat, <span class="dt">ref=</span><span class="ot">FALSE</span>), <span class="dt">treat_var =</span> <span class="st">"treat"</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a>                <span class="dt">cluster_var =</span> <span class="st">"state"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a><span class="co">#&gt; ── Two-stage Difference-in-Differences ─────────────────────────────────────────</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a><span class="co">#&gt; → Running with first stage formula `~ i(state) + i(year)` and treat formula `~ i(treat, ref = FALSE)`</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a><span class="co">#&gt; → The indicator variable that denotes when treatment is on is `treat`</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a><span class="co">#&gt; → Standard errors will be clustered by `state`</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a><span class="co">#&gt; ℹ For more information on the methodology, visit &lt;https://www.kylebutts.com/did2s&gt;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a>fixest<span class="op">::</span><span class="kw">esttable</span>(static)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a><span class="co">#&gt;                            static</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a><span class="co">#&gt; Dependent Var.:           dep_var</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true"></a><span class="co">#&gt;                                  </span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true"></a><span class="co">#&gt; treat = TRUE    2.380*** (0.0614)</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true"></a><span class="co">#&gt; _______________ _________________</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true"></a><span class="co">#&gt; S.E. type                  Custom</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true"></a><span class="co">#&gt; Observations               31,000</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true"></a><span class="co">#&gt; R2                        0.28955</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true"></a><span class="co">#&gt; Adj. R2                   0.28955</span></span></code></pre></div>
<p>This is very close to the true treatment effect of 2.2485745.</p>
<p>Then, let’s estimate an event study did:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="co"># Event Study</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>es &lt;-<span class="st"> </span><span class="kw">did2s</span>(df_het,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>            <span class="dt">yname =</span> <span class="st">"dep_var"</span>, <span class="dt">first_stage_formula =</span> <span class="op">~</span><span class="kw">i</span>(state) <span class="op">+</span><span class="st"> </span><span class="kw">i</span>(year), </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>            <span class="dt">treat_formula =</span> <span class="op">~</span><span class="kw">i</span>(rel_year, <span class="dt">ref=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="ot">Inf</span>)), <span class="dt">treat_var =</span> <span class="st">"treat"</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a>            <span class="dt">cluster_var =</span> <span class="st">"state"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a><span class="co">#&gt; ── Two-stage Difference-in-Differences ─────────────────────────────────────────</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a><span class="co">#&gt; → Running with first stage formula `~ i(state) + i(year)` and treat formula `~ i(rel_year, ref = c(-1, Inf))`</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a><span class="co">#&gt; → The indicator variable that denotes when treatment is on is `treat`</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a><span class="co">#&gt; → Standard errors will be clustered by `state`</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a><span class="co">#&gt; ℹ For more information on the methodology, visit &lt;https://www.kylebutts.com/did2s&gt;</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a>fixest<span class="op">::</span><span class="kw">esttable</span>(es)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true"></a><span class="co">#&gt;                                 es</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true"></a><span class="co">#&gt; Dependent Var.:            dep_var</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true"></a><span class="co">#&gt;                                   </span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true"></a><span class="co">#&gt; rel_year = -20     0.0495 (0.0795)</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true"></a><span class="co">#&gt; rel_year = -19    0.1550. (0.0793)</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true"></a><span class="co">#&gt; rel_year = -18     0.0429 (0.0862)</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true"></a><span class="co">#&gt; rel_year = -17     0.0798 (0.0805)</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true"></a><span class="co">#&gt; rel_year = -16     0.1023 (0.0882)</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true"></a><span class="co">#&gt; rel_year = -15    0.2164* (0.0948)</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true"></a><span class="co">#&gt; rel_year = -14    0.1708* (0.0839)</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true"></a><span class="co">#&gt; rel_year = -13     0.0940 (0.0806)</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true"></a><span class="co">#&gt; rel_year = -12     0.0899 (0.0840)</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true"></a><span class="co">#&gt; rel_year = -11    0.1976* (0.0800)</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true"></a><span class="co">#&gt; rel_year = -10     0.0953 (0.0619)</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true"></a><span class="co">#&gt; rel_year = -9      0.0513 (0.0586)</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true"></a><span class="co">#&gt; rel_year = -8     0.0878* (0.0403)</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true"></a><span class="co">#&gt; rel_year = -7   0.1542*** (0.0440)</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true"></a><span class="co">#&gt; rel_year = -6      0.0221 (0.0510)</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true"></a><span class="co">#&gt; rel_year = -5      0.0351 (0.0490)</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true"></a><span class="co">#&gt; rel_year = -4     -0.0508 (0.0505)</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true"></a><span class="co">#&gt; rel_year = -3     -0.0094 (0.0496)</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true"></a><span class="co">#&gt; rel_year = -2      0.0089 (0.0565)</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true"></a><span class="co">#&gt; rel_year = 0     1.727*** (0.0827)</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true"></a><span class="co">#&gt; rel_year = 1     1.752*** (0.0798)</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true"></a><span class="co">#&gt; rel_year = 2     1.871*** (0.0930)</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true"></a><span class="co">#&gt; rel_year = 3     1.918*** (0.0755)</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true"></a><span class="co">#&gt; rel_year = 4     1.940*** (0.0842)</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true"></a><span class="co">#&gt; rel_year = 5     2.146*** (0.0847)</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true"></a><span class="co">#&gt; rel_year = 6     2.180*** (0.0920)</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true"></a><span class="co">#&gt; rel_year = 7     2.348*** (0.0818)</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true"></a><span class="co">#&gt; rel_year = 8     2.413*** (0.0764)</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true"></a><span class="co">#&gt; rel_year = 9     2.620*** (0.1075)</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true"></a><span class="co">#&gt; rel_year = 10    2.681*** (0.0954)</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true"></a><span class="co">#&gt; rel_year = 11    2.712*** (0.1204)</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true"></a><span class="co">#&gt; rel_year = 12    2.672*** (0.1533)</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true"></a><span class="co">#&gt; rel_year = 13    2.656*** (0.1225)</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true"></a><span class="co">#&gt; rel_year = 14    2.755*** (0.1293)</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true"></a><span class="co">#&gt; rel_year = 15    2.823*** (0.1341)</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true"></a><span class="co">#&gt; rel_year = 16    2.694*** (0.1200)</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true"></a><span class="co">#&gt; rel_year = 17    2.897*** (0.1266)</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true"></a><span class="co">#&gt; rel_year = 18    3.130*** (0.1160)</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true"></a><span class="co">#&gt; rel_year = 19    3.231*** (0.1235)</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true"></a><span class="co">#&gt; rel_year = 20    3.308*** (0.1120)</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true"></a><span class="co">#&gt; _______________ __________________</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true"></a><span class="co">#&gt; S.E. type                   Custom</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true"></a><span class="co">#&gt; Observations                31,000</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true"></a><span class="co">#&gt; R2                         0.30589</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true"></a><span class="co">#&gt; Adj. R2                    0.30501</span></span></code></pre></div>
<p>And plot the results:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a>pts &lt;-<span class="st"> </span>broom<span class="op">::</span><span class="kw">tidy</span>(es) <span class="op">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(term, <span class="st">"rel_year::"</span>)) <span class="op">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">select</span>(<span class="dt">rel_year =</span> term, estimate, <span class="dt">se =</span> std.error) <span class="op">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a>        <span class="dt">rel_year =</span> <span class="kw">as.numeric</span>(<span class="kw">str_remove</span>(rel_year, <span class="st">"rel_year::"</span>)) <span class="op">+</span><span class="st"> </span><span class="fl">0.05</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>        <span class="dt">ci_lower =</span> estimate <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a>        <span class="dt">ci_upper =</span> estimate <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>se,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a>        <span class="dt">group =</span> <span class="st">"Estimated Effect"</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a>    ) <span class="op">%&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(rel_year <span class="op">&lt;=</span><span class="st"> </span><span class="dv">8</span> <span class="op">&amp;</span><span class="st"> </span>rel_year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-8</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true"></a>te_true &lt;-<span class="st"> </span>df_het <span class="op">%&gt;%</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true"></a><span class="st">    </span><span class="co"># Keep only treated units</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(g <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true"></a><span class="st">    </span><span class="kw">group_by</span>(rel_year) <span class="op">%&gt;%</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">estimate =</span> <span class="kw">mean</span>(te <span class="op">+</span><span class="st"> </span>te_dynamic)) <span class="op">%&gt;%</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="st">"True Effect"</span>) <span class="op">%&gt;%</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true"></a><span class="st">    </span><span class="kw">filter</span>(rel_year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-8</span> <span class="op">&amp;</span><span class="st"> </span>rel_year <span class="op">&lt;=</span><span class="st"> </span><span class="dv">8</span>) <span class="op">%&gt;%</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">rel_year =</span> rel_year <span class="op">-</span><span class="st"> </span><span class="fl">0.05</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true"></a>pts &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(pts, te_true)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true"></a>max_y &lt;-<span class="st"> </span><span class="kw">max</span>(pts<span class="op">$</span>estimate)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true"></a><span class="st">    </span><span class="co"># 0 effect</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">"dashed"</span>) <span class="op">+</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">-0.5</span>, <span class="dt">linetype =</span> <span class="st">"dashed"</span>) <span class="op">+</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true"></a><span class="st">    </span><span class="co"># Confidence Intervals</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_linerange</span>(<span class="dt">data =</span> pts, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> rel_year, <span class="dt">ymin =</span> ci_lower, <span class="dt">ymax =</span> ci_upper), <span class="dt">color =</span> <span class="st">"grey30"</span>) <span class="op">+</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true"></a><span class="st">    </span><span class="co"># Estimates</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> pts, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> rel_year, <span class="dt">y =</span> estimate, <span class="dt">color =</span> group), <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true"></a><span class="st">    </span><span class="co"># Label</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_label</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="fl">-0.5</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span>, <span class="dt">y =</span> max_y <span class="op">+</span><span class="st"> </span><span class="fl">0.25</span>, <span class="dt">label =</span> <span class="st">"Treatment Starts ▶"</span>), <span class="dt">label.size=</span><span class="ot">NA</span>,</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true"></a>               <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">label =</span> label), <span class="dt">size =</span> <span class="fl">5.5</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">fontface =</span> <span class="dv">2</span>, <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">-8</span><span class="op">:</span><span class="dv">8</span>, <span class="dt">minor_breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">minor_breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">"Estimated Effect"</span> =<span class="st"> "#013ef5"</span>, <span class="st">"True Effect"</span> =<span class="st"> "#eb3f25"</span>)) <span class="op">+</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Relative Time"</span>, <span class="dt">y =</span> <span class="st">"Estimate"</span>, <span class="dt">color =</span> <span class="ot">NULL</span>, <span class="dt">title =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_kyle</span>(<span class="dt">base_size =</span> <span class="dv">16</span>) <span class="op">+</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true"></a><span class="co">#&gt; Warning: Removed 17 rows containing missing values (geom_segment).</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plot-es-1.png" alt="Event-study plot with example data" width="100%"><p class="caption">
Event-study plot with example data
</p>
</div>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references hanging-indent">
<div id="ref-Gardner_2021">
<p>Gardner, John. 2021. “Two-Stage Difference-in-Differences.” Working Paper. <a href="https://jrgcmu.github.io/2sdd_current.pdf" class="uri">https://jrgcmu.github.io/2sdd_current.pdf</a>.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Kyle Butts <br><small class="roles"> Maintainer </small> <a href="https://orcid.org/0000-0002-9048-8059" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Kyle Butts.</p>
</div>

<div class="pkgdown">
  <p>Made with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1, using <a href="https://preferably.amirmasoudabdol.name/?source=footer">preferably</a> template.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
